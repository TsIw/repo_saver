# 機能仕様

RepoSaver の主要な機能とその動作仕様について記述します。

## 1. 自動バックアップ (デバウンス監視)
- **トリガー**: 設定された「R.E.P.O. セーブデータパス」内のファイル変更を検出。
- **デバウンス制御**:
  - ファイル変更が検出されてから、短時間の連続した書き込みをまとめるため 300 ミリ秒待機します。
  - 待機中に新たな変更があった場合、タイマーをリセットします。
  - これにより、ゲーム保存中の中間状態（一時ファイル等）ではなく、最終的な保存完了後にバックアップを実行します。
- **通知**: バックアップ開始時および完了時にトースト通知を表示します。

## 2. バックアップの世代管理
- 設定された「最大バックアップ保存世代数」に基づき古いデータを自動削除します。
- 世代管理はサブフォルダ（各セーブフォルダ）単位で行われます。
- バックアップはタイムスタンプ形式のフォルダ名で保存されます（例: `2024-01-01_120000`）。

## 3. 手動バックアップとリストア
- **手動バックアップ**: UI上の「今すぐバックアップ」ボタンから、即座にバックアップを実行。
- **リストア**: 
  - 過去の履歴一覧から特定の時点を選択して復元。
  - 復元先は、現在設定されている「R.E.P.O. セーブデータパス」内の対応するサブフォルダ。

## 4. 常駐機能と画面遷移
- **タスクトレイ常駐**: ウィンドウを閉じてもタスクトレイに残り、バックグラウンドで監視を継続します。
- **動的ナビゲーション**: トレイメニューからの設定画面表示や、トレイアイコンクリックによるホーム画面（一覧）表示をサポートします。
- **シングルインスタンス**: 既にアプリが起動している場合、新たなプロセスは起動せずに既存のウィンドウを前面に表示します。
