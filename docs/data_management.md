# データ管理とファイルI/O

RepoSaver が使用するデータ構造と、ファイルシステムへの読み書き仕様について記述します。

## 1. フォルダ構造
バックアップデータは実行ファイルと同じディレクトリの `Backups` フォルダ配下に整理されます。

```text
Backups/
├── SaveDataSlot1/        <-- バックアップ対象のサブフォルダ名
│   ├── meta.json         <-- サブフォルダごとのメモ等のメタ情報
│   ├── 2024-01-01_1000/  <-- 各世代の保存フォルダ
│   └── 2024-01-01_1100/
└── SaveDataSlot2/
```

## 2. 設定ファイル (settings.ini)
アプリケーションの設定は `settings.ini` に保存されます。

- **repo_save_path**: 監視対象のルートパス。
- **max_generations**: 保持する最大バックアップ数 (1-100)。
- **theme**: UIテーマ (`dark`, `light`, `system`)。

## 3. メタデータ (meta.json)
各バックアップカテゴリ（サブフォルダ）には、ユーザーが入力したメモを保持するための `meta.json` が配置されます。

```json
{
  "memo": "第3章ボス戦前"
}
```

## 4. ファイルI/Oの特性
- **コピー方式**: フォルダ全体のディレクトリ同期を行います。Rust の `fs_extra` クレート（または標準の `fs` 再帰）同等のロジックで実装されています。
- **排他制御**: バックアップ実行中およびリストア中は、対象フォルダへの同時アクセスを避けるため、内部的なフラグで保護されます。
- **安全性**: リストア時は、現在のセーブデータを一度削除または上書きするため、事前に注意が必要です。
